{"ast":null,"code":"import _regeneratorRuntime from\"/home/bruno/trabalho/ji/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/bruno/trabalho/ji/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/bruno/trabalho/ji/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import axios from\"axios\";import\"react-dropzone-uploader/dist/styles.css\";import\"./FileDrop.css\";import{base_url}from\"../../config\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function FileDrop(props){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),file=_useState2[0],setFile=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),fileName=_useState4[0],setFileName=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),uploadedFile=_useState6[0],setUploadedFile=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),message=_useState8[0],setMessage=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),uploadPercentage=_useState10[0],setUploadPercentage=_useState10[1];function onChange(e){setFile(e.target.files[0]);setFileName(e.target.files[0].name);}function uploadFile(_x){return _uploadFile.apply(this,arguments);}function _uploadFile(){_uploadFile=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var data,res,_res$data,_fileName,filePath;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();data=new FormData();data.append(\"file\",file);_context.prev=3;_context.next=6;return axios.post(\"\".concat(base_url,\"/images\"),data,{headers:{\"Content-Type\":\"multipart/form-data\"},onUploadProgress:function onUploadProgress(progressEvent){setUploadPercentage(parseInt(Math.round(progressEvent.loaded*100/progressEvent.total)));setTimeout(function(){setUploadPercentage(0);},10000);}});case 6:res=_context.sent;_res$data=res.data,_fileName=_res$data.fileName,filePath=_res$data.filePath;setUploadedFile({fileName:_fileName,filePath:filePath});setMessage(\"Foto Adicionada\");_context.next=15;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](3);if(_context.t0.response.status===500){setMessage(\"erro no servidor\");}else{setMessage(_context.t0.response.data.msg);}case 15:case\"end\":return _context.stop();}}},_callee,null,[[3,12]]);}));return _uploadFile.apply(this,arguments);}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{class:\"mb-3\",children:[message?message:null,/*#__PURE__*/_jsx(\"input\",{className:\"form-control\",type:\"file\",id:\"formFile\",onChange:onChange}),/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",htmlFor:\"formFile\",children:fileName?fileName:\"Selecione um arquivo\"}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Adicionar\",class:\"btn btn-primary btn-block mt-4 col-12\",onClick:uploadFile})]}),/*#__PURE__*/_jsx(\"div\",{class:\"progress\",children:/*#__PURE__*/_jsx(\"div\",{class:\"progress-bar\",style:{width:\"\".concat(uploadPercentage,\"%\")},role:\"progressbar\"})}),uploadedFile?/*#__PURE__*/_jsx(\"div\",{className:\"row mt-5\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6 m-auto \",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-center\",children:uploadedFile.fileName}),/*#__PURE__*/_jsx(\"img\",{style:{width:\"100%\"},src:uploadedFile.filePath,alt:\"\"})]})}):null]});}","map":{"version":3,"sources":["/home/bruno/trabalho/ji/frontend/src/Components/FileDrop/FileDrop.js"],"names":["React","useState","axios","base_url","FileDrop","props","file","setFile","fileName","setFileName","uploadedFile","setUploadedFile","message","setMessage","uploadPercentage","setUploadPercentage","onChange","e","target","files","name","uploadFile","preventDefault","data","FormData","append","post","headers","onUploadProgress","progressEvent","parseInt","Math","round","loaded","total","setTimeout","res","filePath","response","status","msg","width"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\n\nimport axios from \"axios\";\nimport \"react-dropzone-uploader/dist/styles.css\";\nimport \"./FileDrop.css\";\nimport { base_url } from \"../../config\";\n\nexport default function FileDrop(props) {\n  const [file, setFile] = useState(\"\");\n  const [fileName, setFileName] = useState(\"\");\n  const [uploadedFile, setUploadedFile] = useState({});\n  const [message, setMessage] = useState(\"\");\n  const [uploadPercentage, setUploadPercentage] = useState();\n\n  function onChange(e) {\n    setFile(e.target.files[0]);\n    setFileName(e.target.files[0].name);\n  }\n\n  async function uploadFile(e) {\n    e.preventDefault();\n    const data = new FormData();\n    data.append(\"file\", file);\n    try {\n      const res = await axios.post(`${base_url}/images`, data, {\n        headers: {\n          \"Content-Type\": \"multipart/form-data\",\n        },\n        onUploadProgress: (progressEvent) => {\n          setUploadPercentage(\n            parseInt(\n              Math.round((progressEvent.loaded * 100) / progressEvent.total)\n            )\n          );\n          setTimeout(() => {\n            setUploadPercentage(0);\n          }, 10000);\n        },\n      });\n      const { fileName, filePath } = res.data;\n\n      setUploadedFile({ fileName, filePath });\n      setMessage(\"Foto Adicionada\");\n    } catch (err) {\n      if (err.response.status === 500) {\n        setMessage(\"erro no servidor\");\n      } else {\n        setMessage(err.response.data.msg);\n      }\n    }\n  }\n\n  return (\n    <>\n      <div class=\"mb-3\">\n        {message ? message : null}\n        <input\n          className=\"form-control\"\n          type=\"file\"\n          id=\"formFile\"\n          onChange={onChange}\n        />\n        <label className=\"form-label\" htmlFor=\"formFile\">\n          {fileName ? fileName : \"Selecione um arquivo\"}\n        </label>\n        <input\n          type=\"submit\"\n          value=\"Adicionar\"\n          class=\"btn btn-primary btn-block mt-4 col-12\"\n          onClick={uploadFile}\n        />\n      </div>\n      <div class=\"progress\">\n        <div\n          class=\"progress-bar\"\n          style={{ width: `${uploadPercentage}%` }}\n          role=\"progressbar\"\n        ></div>\n      </div>\n      {uploadedFile ? (\n        <div className=\"row mt-5\">\n          <div className=\"col-md-6 m-auto \">\n            <h3 className=\"text-center\">{uploadedFile.fileName}</h3>\n            <img style={{ width: \"100%\" }} src={uploadedFile.filePath} alt=\"\" />\n          </div>\n        </div>\n      ) : null}\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}